{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {"url": "https://raw.githubusercontent.com/multipletwigs/Malaysia-COVID-Analysis/main/COVID-Data/COVID-19%20Statistics/epidemic/cases_malaysia.csv"},
    "transform": [
        {"calculate": "timeParse(datum['date'], '%d/%m/%Y')", 
         "as": "date"
        },
        {"calculate": "(datum.cumul_partial / 32657400) * 100", 
            "as": "partial_percentage"
        },
        {"calculate": "(datum.cumul_full / 32657400) * 100", 
            "as": "full_percentage"
        }
    ],
    "vconcat":[
        {
            "width":"container",
            "height":"container",
            "layer":[
                {
                    "mark":{
                        "type": "area",
                        "color": "#e1f0ff",
                        "interpolate":"natural"
                    },
                    "encoding": {
                        "x":{
                            "field":"date", 
                            "type":"temporal",
                            "axis":{"title":null, "grid": false},
                            "scale":{
                                "domain":{
                                    "param":"brush"
                                }
                            }
                        },
                        "y":{
                            "field":"cases_new",
                            "type":"quantitative",
                            "axis":{
                                "title":"Daily New Cases", 
                                "labelFont": "Roboto", 
                                "labelFontSize": 15,
                                "titleFont": "Roboto",
                                "titleFontSize":15
                            }
                        }
                    }
                },
                {
                    "mark":{
                        "type": "line",
                        "color": "#3699ff",
                        "size": 2,
                        "interpolate":"natural"
                    },
                    "encoding": {
                        "x":{
                            "field":"date", 
                            "type":"temporal",
                            "axis":{"title":null, "grid": false},
                            "scale":{
                                "domain":{
                                    "param":"brush"
                                }
                            }
                        },
                        "y":{
                            "field": "cases_new",
                            "type": "quantitative",
                            "axis":null
                        }
                    }

                },{
                    "mark":{
                        "type": "line",
                        "color": "grey",
                        "size": 2,
                        "interpolate":"natural",
                        "strokeDash":[8,8]
                    },
                    "encoding": {
                        "x":{
                            "field":"date", 
                            "type":"temporal",
                            "axis":{"title":null, "grid": false},
                            "scale":{
                                "domain":{
                                    "param":"brush"
                                }
                            }
                        },
                        "y":{
                            "field":"partial_percentage",
                            "type":"quantitative",
                            "axis":null,
                            "scale": {"domain": [0, 100]}
                        }
                    }
                },
                {
                    "mark":{
                        "type": "line",
                        "color": "grey",
                        "size": 2,
                        "interpolate":"natural"
                    },
                    "encoding": {
                        "x":{
                            "field":"date", 
                            "type":"temporal",
                            "axis":{"title":null, "grid": false, "labelFont": "Roboto", "titleFont": "Roboto"},
                            "scale":{
                                "domain":{
                                    "param":"brush"
                                }
                            }
                        },
                        "y":{
                            "field":"full_percentage",
                            "type":"quantitative",
                            "axis":{
                                "title":"percentage (%)", 
                                "labelFont": "Roboto", 
                                "labelFontSize": 15,
                                "titleFont": "Roboto",
                                "titleFontSize":15
                            },
                            "scale": {"domain": [0, 100]}
                        }
                    }
                }
            ],
            "resolve": {"scale": {"y": "independent"}}
        },
        {
            "width":"container",
            "height":60,
            "layer":[
                {
                    "mark":{
                        "type": "area",
                        "color": "#e1f0ff"
                    },
                    "params": [
                        {
                            "name":"brush",
                            "select":{
                                "type":"interval",
                                "encodings": ["x"]
                            }
                        }
                    ],
                    "encoding": {
                        "x":{
                            "field":"date", 
                            "type":"temporal"
                        },
                        "y":{
                            "field":"cases_new",
                            "type":"quantitative",
                            "axis":{"title": null, "tickCount":3, "grid": false}
                        }
                    }
                }
            ]
        }
    ]
}